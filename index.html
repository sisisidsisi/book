<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Exchange</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- 1. 홈 페이지 -->
        <div id="home" class="page active">
            <div class="home-header-area">
                <div class="search-bar">
                    <span>🔍</span>
                    <input type="text" id="searchInput" placeholder="도서명, 작가 검색" oninput="filterBooks()">
                </div>
            </div>

            <section class="section">
                <h2 class="section-title">모집 중인 교환독서</h2>
                <div class="horizontal-scroll" id="recruit-list">
                    <div class="card-tall"><div class="loading-skeleton"></div></div>
                </div>
            </section>

            <section class="section">
                <h2 class="section-title">추천 교환독서</h2>
                <div style="font-size:11px; color:#999; margin-bottom:10px;">* 구글 시트 랭킹 연동</div>
                <div class="vertical-list" id="recommend-list">
                    <div class="card-grid"><div class="loading-skeleton"></div></div>
                </div>
            </section>
        </div>

        <!-- 2. 교환 페이지 -->
        <div id="exchange" class="page">
            <header class="common-header"><h2>나의 독서 메이트 💬</h2></header>
            
            <section class="section">
                <h2 style="font-size:16px; font-weight:700; margin-bottom:10px; color:#555;">내가 만든 모임 👑</h2>
                <div id="hosting-list"></div>
                <div style="height:20px;"></div>
                <h2 style="font-size:16px; font-weight:700; margin-bottom:10px; color:#555;">참여 중인 모임 🙋‍♀️</h2>
                <div id="joined-list"></div>
            </section>
            
            <div class="fab" onclick="location.href='register.html'">✏️</div>
        </div>

        <!-- 교환 상세 페이지 (수정됨: 상태 표시 및 액션 버튼) -->
        <div id="exchange-detail" class="page" style="z-index: 20; background: var(--bg-color);">
            <header class="common-header">
                <button class="back-btn" onclick="goBack()">⬅️</button>
                <div style="display:flex; flex-direction:column;">
                    <h2 id="ex-detail-title">책 제목</h2>
                    <span style="font-size:12px; color:var(--text-sub);">함께 읽는 중 • <span id="ex-detail-dday" style="color:#FF8A80; font-weight:bold;"></span></span>
                </div>
            </header>
            
            <section class="section" style="padding-top:10px;">
                <!-- 독서 현황 텍스트 추가 -->
                <div id="reading-status-text" style="text-align:center; margin-bottom:15px; font-weight:bold; color:#555;">
                    현재 3명 중 1명 완독 (33%)
                </div>

                <div class="participant-list">
                    <!-- JS로 동적 제어됨 (기존 하드코딩 제거) -->
                    <div class="participant done"><div class="p-avatar" style="background-image:url('https://via.placeholder.com/55/AEEEEE/fff?text=Me');"></div><span class="p-name">나</span></div>
                    <div class="participant"><div class="p-avatar" style="background-image:url('https://via.placeholder.com/55/E0E0E0/fff?text=User');"></div><span class="p-name">멤버</span></div>
                </div>
                
                <!-- 액션 버튼 (상황에 따라 텍스트/기능 변경) -->
                <button id="btn-detail-action" class="btn-full" style="margin-top:15px; background-color:#8CD790;" onclick="handleDetailAction()">
                    이 모임 참여하기 👋
                </button>
            </section>

            <section class="section" style="flex:1;">
                <h3 style="font-size:15px; margin-bottom:10px;">함께 읽는 수다방 💬</h3>
                <div class="review-area">
                    <div class="review-list" id="review-list"></div>
                    <div class="input-area"><input type="text" id="review-input" placeholder="메시지 입력..."><button class="btn-send" onclick="addReview()">➤</button></div>
                </div>
            </section>
        </div>

        <!-- 3. 마이 페이지 -->
        <div id="my" class="page">
            <header class="common-header"><h2>마이 페이지 👤</h2></header>
            <section class="section">
                <div class="profile-card">
                    <div class="profile-img-lg" id="my-profile-img" style="background-image:url('https://via.placeholder.com/80/7BC4B2/fff?text=Cat');"></div>
                    <div><h3 style="font-size:18px; margin-bottom:5px;" id="my-nickname">책읽는냥이</h3></div>
                </div>
                <div class="menu-list">
                    <div class="menu-item" onclick="switchTab('settings-profile')"><span>✏️ 프로필 수정</span><span>›</span></div>
                    <div class="menu-item" onclick="handleLogout()"><span style="color:#FF8A80;">🚪 로그아웃</span></div>
                </div>
            </section>
        </div>

        <!-- 설정 페이지 -->
        <div id="settings-profile" class="page">
            <header class="common-header"><button class="back-btn" onclick="goBack()">⬅️</button><h2>프로필 수정</h2></header>
            <section class="section"><input type="text" id="edit-nickname" value="책읽는냥이" style="width:100%; padding:10px;"><button class="btn-full" onclick="saveProfile()">저장</button></section>
        </div>

        <nav class="bottom-nav">
            <button class="nav-item active" onclick="switchTab('home')"><span class="nav-icon">🏠</span><span>홈</span></button>
            <button class="nav-item" onclick="switchTab('exchange')"><span class="nav-icon">💬</span><span>교환</span></button>
            <button class="nav-item" onclick="switchTab('my')"><span class="nav-icon">👤</span><span>마이</span></button>
        </nav>
    </div>

    <!-- 스크립트 연결 -->
    <script src="script.js"></script>
</body>
</html>
